---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
download.file(url ="https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", dest = paste(getwd(), "/activity.zip", sep = ""))
activity <- unzip("activity.zip") 
activity <- read.csv(activity, header = TRUE)
head(activity)


## What is mean total number of steps taken per day?
Nsteps <- aggregate(activity["steps"], by = list(date = activity$date), FUN = sum, na.rm = TRUE)
hist(Nsteps$steps, main = "Total steps taken each day", xlab = "Steps", ylab = "Frequency", breaks = 30)


## What is the average daily activity pattern?
meanstep <- mean(Nsteps$steps)
medianstep <- median(Nsteps$steps)
print(paste("The mean and median number of steps taken each day is respectively", meanstep, "and", medianstep))
list(interval = activity$interval), FUN = mean, na.rm = TRUE)
plot(Asteps$interval, Asteps$steps, type = "l", xlab = "interval", ylab = "steps", main = "Time Series Plot of The Average Number of Steps Taken")

## Imputing missing values
totalSteps <- aggregate(activity["steps"], by = list(dates = activity$date), FUN = sum, na.rm = TRUE)
hist(totalSteps$steps, breaks = 30, main = "Total Number of Steps taken each day", xlab = "Steps", ylab = "Frequency")

## Are there differences in activity patterns between weekdays and weekends?
date <- as.Date(as.character(activity$date))
wdate <- weekdays(date)
weekendindicator <- (wdate == "Saturday" | wdate == "Sunday")
weekindicator <- (wdate != "Saturday" & wdate != "Sunday")
wdate[weekendindicator] <- "Weekends"
wdate[weekindicator] <- "Weekdays"
stepdate <- aggregate(activity["steps"], by = list(date = wdate, interval = activity$interval), FUN = mean, na.rm = TRUE)
par(mfrow = c(1, 2))
with(stepdate[stepdate$date == "Weekdays", ], plot(interval, steps, type = "l", col = "red", ylim = c(0, 250), main = "Avg.No.steps during Weekdays"))
with(stepdate[stepdate$date == "Weekends", ], plot(interval, steps, type = "l", col = "light blue", ylim = c(0, 250), main = "Avg.No.steps during Weekends"))
